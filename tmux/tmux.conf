# ---------------
# Binds / Unbinds
# ---------------
bind v split-window -h
bind s split-window -v
bind Escape copy-mode
bind '~' switch-client -Thor
bind '`' switch-client -Tver
bind -Thor h split-window "htop"
bind -Tver h split-window -h "htop"
bind -Thor n split-window "nmon"
bind -Tver n split-window -h "nmon"
bind -Thor t split-window -c "#{pane_current_path}" "tig"
bind -Tver t split-window -c "#{pane_current_path}" -h "tig"
bind -Thor l command-prompt "split-window 'tail -f %%'"
bind -Tver l command-prompt "split-window -h 'tail -f %%'"
bind -Thor / command-prompt "split-window 'man %%'"
bind -Tver / command-prompt "split-window -h 'man %%'"

bind Q confirm kill-window
bind S confirm kill-server
bind m set-option status
bind -n S-Right next-window
bind -n S-Left previous-window
bind -n C-S-Right swap-window -d -t +1
bind -n C-S-Left swap-window -d -t -1
bind -n C-T new-window -c "#{pane_current_path}"

# Synchronize panes (type in all panes at once) - prefix + y
bind y setw synchronize-panes

# -----------
# Set Options
# -----------
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*256col*:Tc"

# Start numbering at 1 (easier to reach on keyboard)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Display settings
set -g display-panes-time 2000
set -g display-time 2000

# Keep activity monitoring but disable visual notifications
# Windows with activity will still be highlighted in status bar
set -g visual-activity off
set -g visual-bell off

# Terminal title
set -g set-titles on
set -g set-titles-string "#T"

# History limit
set -g history-limit 50000

# Reduce escape time (better for vim/nvim)
set -sg escape-time 10

# Focus events for vim/nvim
set -g focus-events on

# Aggressive resize (only resize if smaller client actively viewing)
setw -g aggressive-resize on

# Enable xterm keys
setw -g xterm-keys on

# Monitor activity but reduce false positives
setw -g monitor-activity on
set -g monitor-silence 0

# Mode keys (emacs-style)
setw -g mode-keys emacs

# Alternate screen
setw -g alternate-screen on

# Mouse support
set -g -q mouse on

# Keep the server running even when there are no sessions/clients
set -g exit-empty off
set -g exit-unattached off

# -------
# Plugins
# -------
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-pain-control'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-sidebar'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-logging'
set -g @plugin 'jbnicolai/tmux-fpp'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

# System monitoring plugins
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-battery'

# Session persistence
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Resurrect options
set -g @resurrect-capture-pane-contents 'on'
set -g @resurrect-strategy-vim 'session'

# Continuum options (auto-save every 15 minutes)
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# -----
# Theme - Choose one (uncomment to activate)
# -----

# Tokyo Night
set -g @plugin 'janoamaral/tokyo-night-tmux'
set -g @tokyo-night-tmux_theme storm
set -g @tokyo-night-tmux_transparent 0  # 1 or 0
set -g @tokyo-night-tmux_show_hostname 1
set -g @tokyo-night-tmux_show_path 1
set -g @tokyo-night-tmux_path_format relative # 'relative' or 'full'

# Nord
# set -g @plugin 'arcticicestudio/nord-tmux'

# To switch themes:
# 1. Comment out current theme
# 2. Uncomment desired theme
# 3. Press prefix + I to install new plugin

run -b '~/.config/tmux/plugins/tpm/tpm'
